BiocManager::install("Mfuzz")
library(mfuzz)
library(Mfuzz)
?mfuzz
.libPaths()
library(richR)
sessionInfo()
.libPaths()
update.packages(ask = FALSE)
BiocManager::install(version = "3.21")
BiocManager::install(version = "3.21")
BiocManager::install(version = "3.21")
BiocManager::install(version = "3.21")
options(repos = c(CRAN = "https://cran.r-project.org"))
library(MetaboAnalystR)
# Step 2: Install MetaboAnalystR without documentation
devtools::install_github("xia-lab/MetaboAnalystR", build = TRUE, build_vignettes = FALSE)
load("C:/JHCloud/University of Michigan Dropbox/Junguk Hur/!RESEARCH/Kai_Projects_2023-2025/DN/DREX_scRNAseq/Analysis/02_Analyses/SEN_MYO_mouse.rdata")
mouse
load("C:/JHCloud/University of Michigan Dropbox/Junguk Hur/!UMICH/KaiProjects/DN/High-Fat-Fed/HF22_DMM/Data/ProcessedData/HF22_rna.rdata")
View(HFSTZDR24_vs_ctrl16)
View(HFSTZDR24_vs_ctrl24)
View(HFSTZDR24_vs_HF16)
View(HFSTZDR24_vs_HF24)
View(HFSTZDR24_vs_HFDR24)
View(HFSTZDR24_vs_HFSTZ16)
View(HFSTZDR24_vs_HFSTZ22)
View(drg)
View(ds)
View(groupd)
View(groups)
View(scn)
View(wk_16)
View(wk_24)
View(dd)
View(df)
View(ds)
View(ds)
View(group)
View(inter)
View(lc)
View(lc2)
View(res24)
View(res_drg)
View(res_drg)
View(res_scn)
View(res_drg)
View(res_scn)
load("C:/JHCloud/University of Michigan Dropbox/Junguk Hur/!RESEARCH/Kai_Projects_2023-2025/DN/Keto_PNS/Analysis/02_Analyses_Create_multiple_folders_as_needed/new_results_all.rdata")
names(scn)
scn
scns
gastrocs
hippos
names(hippos)
names(scns)
names(gastrocs)
gastrocs$HFDvsSD$padj
gastrocs$HFDvsSD$pvalue
max(gastrocs$HFDvsSD$pvalue)
gastrocs$HFDvsSD$padj
update.packages(checkBuilt = TRUE, ask = FALSE)
BiocManager::install(ask = FALSE)
remotes::update_packages()
gc()
gc(reset=TRUE)
myGeneSymbols <- c("COL3A1","AR","HGAL","PLXNA4")
# 5) do all downstream mapping with keytype = "SYMBOL"
res <- AnnotationDbi::select(org.Hs.eg.db, keys = syms_final,
columns = c("ENTREZID","GENENAME","ENSEMBL"),
keytype = "SYMBOL")
library(org.Hs.eg.db)
myGeneSymbols <- c("COL3A1","AR","HGAL","PLXNA4")
# 5) do all downstream mapping with keytype = "SYMBOL"
res <- AnnotationDbi::select(org.Hs.eg.db, keys = syms_final,
columns = c("ENTREZID","GENENAME","ENSEMBL"),
keytype = "SYMBOL")
# 5) do all downstream mapping with keytype = "SYMBOL"
res <- AnnotationDbi::select(org.Hs.eg.db, keys = myGeneSymbols,
columns = c("ENTREZID","GENENAME","ENSEMBL"),
keytype = "SYMBOL")
res
colnames(org.Hs.eg.db)
# check what is available in this annotatino data
columns(org.Hs.eg.db)
library(org.Hs.eg.db)
keytypes(org.Hs.eg())
keytypes(org.Hs.eg.db)
columns(org.Hs.eg.db)
keytpes()
keytypes()
keytypes
columns
AnnotationDbi::columns
knitr::opts_chunk$set(echo = TRUE)
############################################################################
# It is recommended to run line by line rather than the whole chunk together
############################################################################
if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager", quiet=TRUE)
if (!require("reactome.db", quietly = TRUE)) BiocManager::install("reactome.db", dependencies = TRUE, ask = FALSE)
if (!require("org.Hs.eg.db", quietly = TRUE)) BiocManager::install("org.Hs.eg.db", dependencies = TRUE, ask = FALSE)
if (!require("igraph", quietly = TRUE)) install.packages("igraph")
if (!require("ggplot2", quietly = TRUE)) install.packages("ggplot2")
if (!require("devtools", quietly = TRUE)) install.packages("devtools")
if (!require("richR", quietly = TRUE)) devtools::install_github("guokai8/richR")
knitr::opts_chunk$set(echo = TRUE)
############################################################################
# It is recommended to run line by line rather than the whole chunk together
############################################################################
if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager", quiet=TRUE)
if (!require("reactome.db", quietly = TRUE)) BiocManager::install("reactome.db", dependencies = TRUE, ask = FALSE)
if (!require("org.Hs.eg.db", quietly = TRUE)) BiocManager::install("org.Hs.eg.db", dependencies = TRUE, ask = FALSE)
if (!require("igraph", quietly = TRUE)) install.packages("igraph")
if (!require("ggplot2", quietly = TRUE)) install.packages("ggplot2")
if (!require("devtools", quietly = TRUE)) install.packages("devtools")
if (!require("richR", quietly = TRUE)) devtools::install_github("guokai8/richR")
install.packages("devtools")
knitr::opts_chunk$set(echo = TRUE)
############################################################################
# It is recommended to run line by line rather than the whole chunk together
############################################################################
if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager", quiet=TRUE)
if (!require("reactome.db", quietly = TRUE)) BiocManager::install("reactome.db", dependencies = TRUE, ask = FALSE)
if (!require("org.Hs.eg.db", quietly = TRUE)) BiocManager::install("org.Hs.eg.db", dependencies = TRUE, ask = FALSE)
if (!require("igraph", quietly = TRUE)) install.packages("igraph")
if (!require("ggplot2", quietly = TRUE)) install.packages("ggplot2")
if (!require("devtools", quietly = TRUE)) install.packages("devtools")
if (!require("richR", quietly = TRUE)) devtools::install_github("guokai8/richR")
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github("guokai8/richR")
knitr::opts_chunk$set(echo = TRUE)
############################################################################
# It is recommended to run line by line rather than the whole chunk together
############################################################################
if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager", quiet=TRUE)
if (!require("reactome.db", quietly = TRUE)) BiocManager::install("reactome.db", dependencies = TRUE, ask = FALSE)
if (!require("org.Hs.eg.db", quietly = TRUE)) BiocManager::install("org.Hs.eg.db", dependencies = TRUE, ask = FALSE)
if (!require("igraph", quietly = TRUE)) install.packages("igraph")
if (!require("ggplot2", quietly = TRUE)) install.packages("ggplot2")
if (!require("devtools", quietly = TRUE)) install.packages("devtools")
if (!require("richR", quietly = TRUE)) devtools::install_github("guokai8/richR")
install.packages("SingleR")install.packages("SingleR")
install.packages("SingleR")
if (!require("STRINGdb", quietly = TRUE)) BiocManager::install("STRINGdb", dependencies = TRUE, ask = FALSE)
load("C:/JHCloud/University of Michigan Dropbox/Junguk Hur/!RESEARCH/Kai_Projects_2023-2025/DN/DREX_fluxomics/Data/ProcessedData/26wk/26wk_sum.rdata")
distcolors
load("C:/JHCloud/University of Michigan Dropbox/Junguk Hur/!RESEARCH/Kai_Projects_2023-2025/DN/DREX_fluxomics/Data/ProcessedData/26wk/fluxomics_26wk_final_m0.rdata")
if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager", quiet=TRUE)
if (!require("reactome.db", quietly = TRUE)) BiocManager::install("reactome.db", dependencies = TRUE, ask = FALSE)
if (!require("org.Hs.eg.db", quietly = TRUE)) BiocManager::install("org.Hs.eg.db", dependencies = TRUE, ask = FALSE)
if (!require("igraph", quietly = TRUE)) install.packages("igraph")
if (!require("ggplot2", quietly = TRUE)) install.packages("ggplot2")
if (!require("devtools", quietly = TRUE)) install.packages("devtools")
if (!require("richR", quietly = TRUE)) devtools::install_github("guokai8/richR")
setwd("Z:/home/juhur/PROJECTS/DPN_DREX_HumanSpatial")
outputdir = "output/"        # directory to save output files
dir.create(paste(dirname(current_path),outputdir,sep="/"), showWarnings = FALSE)
library(rstudioapi)
current_path <- dirname(getActiveDocumentContext()$path)
setwd(current_path)
outputdir = "output/"        # directory to save output files
dir.create(paste(dirname(current_path),outputdir,sep="/"), showWarnings = FALSE)
filebase  = "RegenDegen"     # base file name
top       = 25               # number of top significant terms to be included in the output
args <- commandArgs(trailingOnly = FALSE)
script_path <- sub("--file=", "", args[grep("--file=", args)])
current_path <- dirname(script_path)
setwd(current_path)
setwd_to_script <- function() {
# 1) RStudio active document, if available
if (requireNamespace("rstudioapi", quietly = TRUE)) {
if (tryCatch(rstudioapi::isAvailable(), error = function(e) FALSE)) {
p <- tryCatch(rstudioapi::getActiveDocumentContext()$path, error = function(e) "")
if (nzchar(p)) {
dir <- normalizePath(dirname(p), winslash = "/", mustWork = FALSE)
setwd(dir)
return(dir)
}
}
}
# 2) Rscript execution
args <- commandArgs(trailingOnly = FALSE)
m <- grep("^--file=", args)
if (length(m) == 1) {
p <- sub("^--file=", "", args[m])
if (nzchar(p)) {
dir <- normalizePath(dirname(p), winslash = "/", mustWork = FALSE)
setwd(dir)
return(dir)
}
}
# 3) Sourced script
ofile <- tryCatch(sys.frame(1)$ofile, error = function(e) NULL)
if (!is.null(ofile) && nzchar(ofile)) {
dir <- normalizePath(dirname(ofile), winslash = "/", mustWork = FALSE)
setwd(dir)
return(dir)
}
# 4) Fallback
dir <- normalizePath(getwd(), winslash = "/", mustWork = FALSE)
message("Could not detect script path. Using current working directory: ", dir)
return(dir)
}
# Use it
current_path <- setwd_to_script()
# Example: create an output folder under the script directory
outputdir <- "output"
dir.create(file.path(current_path, outputdir), showWarnings = FALSE, recursive = TRUE)
# Example: create an output folder under the script directory
outputdir <- "output"
dir.create(file.path(current_path, outputdir), showWarnings = FALSE, recursive = TRUE)
outputdir = "output/"        # directory to save output files
filebase  = "RegenDegen"     # base file name
top       = 25               # number of top significant terms to be included in the output
## Gene ontology using GO.db
hsa_go <- buildAnnot(species="human", keytype="SYMBOL", anntype = "GO")
## KEGG pathway using KEGG.db (public version; depricated)
hsa_ko <- buildAnnot(species="human", keytype="SYMBOL", anntype = "KEGG", builtin = FALSE)
## Reactome pathway database
hsa_ro <- buildAnnot(species="human", keytype="SYMBOL", anntype = "Reactome")
# Load the example data
dat <- read.table ("./allResultRegen.Degen.txt", header=T, sep="\t")
colnames(dat)[1] <- "gene"
dat.sig <- dat[which(dat$padj<0.05),]
head(dat.sig)
# ----------------------------------------------------
# Gene Ontology analysis
# ----------------------------------------------------
## minimal paraters
GO.res <- richGO(dat.sig$gene, godata=hsa_go, ontology ="BP")
head(GO.res)
## additional parameters
GO.res <- richGO(dat.sig$gene, godata=hsa_go, ontology ="BP",
pvalue = 0.05, padj = 0.10, minSize = 2, maxSize = 500,
keepRich = TRUE, filename=paste0(outputdir,filebase,".GO.out"),
padj.method="BH", sep=", ")
GO.sig <- filter(GO.res, Padj<0.05)
write.csv (GO.sig, file=paste0(outputdir, filebase, "_GO.csv"))
# Bar plot of top enrichment terms
## minimal parameter
ggbar(GO.sig, top = 20, usePadj = T)
ggbar(GO.sig, top = 20, usePadj = T, horiz=F) + ylab("% in genome") + ggtitle("Enrichment analysis")
## This part may not work in Rmarkdown
## if it doesn't, try to open a device first before creating the image
## pdf(paste0(outputdir,filebase,"_GO-bar_Top20.pdf")) and
## then dev.off() once graph is created.
dev.copy(pdf, paste0(outputdir,filebase,"_GO-bar_Top20.pdf"))
dev.off()
## alternative use ggsave
ggsave(paste0(outputdir,filebase,"_GO-bar_Top20.pdf"))
## additional parameters
ggbar(GO.sig, top = top, order = FALSE, fontsize.x = 10, fontsize.y = 10, usePadj = TRUE,
filename = paste0(outputdir,filebase,"_GO-bar_Top",top,".pdf"), width=10, height=8)
## PDF file is automatically created and saved
# dot plot of top enrichment terms
## minimal parameter
ggdot(GO.sig, top = 20, usePadj = T)
dev.copy(pdf, paste0(outputdir,filebase,"_GO-dot_Top20.pdf"))
dev.off()
## additional parameters
ggdot(GO.sig, top = top, pvalue = 0.05,
order = FALSE, fontsize.x = 10, fontsize.y = 10, usePadj = TRUE,
filename = paste0(outputdir,filebase,"_GO-dot_Top",top,".pdf"),
width=10, height=8)
## PDF file is automatically created and saved
# ----------------------------------------------------
# KEGG analysis
# ----------------------------------------------------
# Same as the above GO analysis
## minimal paraters
## Note that you use builtin=FALSE here as well
KEGG.res <- richKEGG(dat.sig$gene, kodata=hsa_ko, pvalue=0.05, builtin = FALSE)
head(KEGG.res)
KEGG.sig <- filter(KEGG.res, Padj < 0.05)
write.csv (KEGG.sig, file=paste0(outputdir, filebase, "_KEGG.csv"))
ggdot(KEGG.sig,top=10,usePadj = F)
ggbar(KEGG.sig,top=10,usePadj = F)
